<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
        <title>Document</title>
        <style>
            /* .secondchild {
                        height: 200px;
                        width: 200px;
                        background-color: red;
                    } */

            body {
                margin: 0;
                padding: 0;
                height: 100dvh;
                width: 100%;
                display: flex;
                justify-content: center;
                align-items: center;
            }

            .parent {
                background-color: red;
                display: grid;
                /* grid-template-areas: "a"; */
                grid-auto-rows: 75px;
            }
            .child {
                border: 1px solid black;
                text-align: center;
                align-content: center;
            }
            .spam-item {
                grid-column: span 2;
            }
        </style>
    </head>
    <body>
        <label for="category-select">Choose a category:</label>
        <select id="category-select">
            <option value="">--Please choose an option--</option>
        </select>

        <br /><br />

        <label for="item-select">Choose an item:</label>
        <select id="item-select" disabled>
            <option value="">--Please choose a category first--</option>
        </select>

        <script>
            fetch("/admin/api/student/timetable/new")
                .then((response) => response.json())
                .then((data) => {
                    const categorySelect =
                        document.getElementById("category-select");

                    // Populate the first dropdown with categories
                    data.forEach((category) => {
                        const option = document.createElement("option");
                        option.value = category._id;
                        option.textContent = category.name;
                        categorySelect.appendChild(option);
                    });
                })
                .catch((error) =>
                    console.error("Error fetching categories:", error),
                );

            // Add event listener to the first dropdown
            document
                .getElementById("category-select")
                .addEventListener("change", function () {
                    const selectedCategoryId = this.value;
                    console.log(selectedCategoryId);

                    if (selectedCategoryId) {
                        fetch(
                            `/admin/api/student/timetable/new/${selectedCategoryId}`,
                        )
                            .then((response) => response.json())
                            .then((data) => {
                                const itemSelect =
                                    document.getElementById("item-select");
                                itemSelect.innerHTML = "";
                                itemSelect.disabled = false;

                                data.forEach((item) => {
                                    const option =
                                        document.createElement("option");
                                    option.value = item._id;
                                    option.textContent = item.class_id;
                                    itemSelect.appendChild(option);
                                });
                            })
                            .catch((error) =>
                                console.error("Error fetching items:", error),
                            );
                    } else {
                        // Disable the second dropdown if no category is selected
                        document.getElementById("item-select").disabled = true;
                        document.getElementById("item-select").innerHTML =
                            '<option value="">--Please choose a category first--</option>';
                    }
                });
        </script>
    </body>
</html>
